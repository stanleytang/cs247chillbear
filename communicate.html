<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Ratchet template page</title>

    <!-- Sets initial viewport load and disables zooming  -->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

    <!-- Makes your prototype chrome-less once bookmarked to your phone's home screen -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <!-- Include the compiled Ratchet CSS -->
    <link href="bower_components/ratchet/dist/css/ratchet.css" rel="stylesheet">
    <link href="bower_components/ratchet/dist/css/ratchet-theme-ios.css" rel="stylesheet">
    <link href="bower_components/ratchet/dist/css/main.css" rel="stylesheet">

    <!-- Include the compiled Ratchet JS -->
    <script src="bower_components/ratchet/dist/js/ratchet.js"></script>
    <script src="bower_components/jquery/dist/jquery.js"></script>
    <script src="bower_components/ratchet/js/push.js"></script>
    <script src='https://cdn.firebase.com/js/client/1.0.11/firebase.js'></script>
  </head>
  <body>

    <!-- Make sure all your bars are the first things in your <body> -->
    <header class="bar bar-nav">
    	<a class="btn btn-link btn-nav pull-left index_back" href="index.html" data-transition="slide-out">
		    <span class="icon icon-left-nav"></span>
		    Back
		  </a>
      <h1 class="title">Andy</h1>
    </header>

    <div class="content">
    	<div class="content-padded communicate">
    		<img class="img" src="http://upload.wikimedia.org/wikipedia/commons/0/06/Cabo_San_Lucas_Los_Arcos_3.jpg"/>
    		<div class="chat_container" id="chatbox">
					<div class="bubble">
						Check out Cabo!
					</div>
				</div>
	    	<form  class="communicate_form">
				  <input type="text" id="messageInput" placeholder="type something...">
				  <!-- <button class="btn btn-positive btn-block">Send</button> -->
				</form>
			</div>
    </div>
    <script>
      $(".index_back").click(function() {
        PUSH({url:'index.html', transition: 'slide-out' });
      });
      var myDataRef = new Firebase('https://dazzling-fire-7228.firebaseio.com/');
      $('#messageInput').keypress(function (e) {
        if (e.keyCode == 13) {
          var text = $('#messageInput').val();
          myDataRef.push({name: 'Andy', text: text});
          $('#messageInput').val('');
        }
      });
      myDataRef.on('child_added', function(snapshot) {
        var message = snapshot.val();
        displayChatMessage(message.name, message.text);
      });
      function displayChatMessage(name, text) {
      	var appendText = '<div class="bubble bubble--alt">'+text+'</div>'
      	$("#chatbox").append(appendText);
        //$('#messagesDiv')[0].scrollTop = $('#messagesDiv')[0].scrollHeight;
      };
    </script>
  </body>
</html>